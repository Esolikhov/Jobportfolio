import pandas as pd
import re
from google.colab import files

# Функция для извлечения русских букв
def extract_russian(text):
    return ''.join(re.findall(r'[а-яА-ЯёЁ]', str(text)))

# Загрузка файла в Colab
uploaded = files.upload()

# Получаем имя загруженного файла
input_file = next(iter(uploaded))

# Загрузка Excel файла с использованием pandas
def process_excel(input_file):
    # Чтение Excel файла с использованием pandas
    df = pd.read_excel(input_file)

    # Проверка наличия столбца 'Номенклатура'
    if 'Номенклатура' not in df.columns:
        print("Столбец 'Номенклатура' не найден в файле!")
        return

    # Применяем функцию для извлечения русских букв из столбца 'Номенклатура'
    df['Название'] = df['Номенклатура'].apply(extract_russian)

    # Сохранение обработанного файла
    output_file = "processed_file.xlsx"
    df.to_excel(output_file, index=False)

    print(f"Обработанный файл сохранен как {output_file}")

    # Скачивание обработанного файла
    files.download(output_file)

# Обработка и скачивание файла
process_excel(input_file)
